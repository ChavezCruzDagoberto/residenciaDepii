{{!-- AGREGAR SUBPARTIDA --}}

{{!-- Este div ajusta el contenido para que no interfiera con la barra. --}}
<div class="main" id="principal">

    {{!-- Este div permite ocupar el 100% del espacio vertical disponible --}}
    <div class="container w-100">

        {{!-- div centra horizontalmente el contenido --}}
        <div class="d-flex justify-content-center vh-80">

            {{!-- div centra verticalmente el contenido --}}
            <div class="my-auto w-100" align="center" id="contenedorprincipal">

                <div class="w-100 mb-5">
                    <h1> Agregar Subpartida. </h1>
                </div>

                <div class="d-flex justify-content-center">
                    {{!-- Comienza el formulario --}}
                    <form action="/subpartida/add" method="POST">

                        <div class="container">
                            <div class="row">
                                <div class="col-sm-6" align="right">
                                    <label for="clave_partida" class="m-2"> Clave de la partida </label>
                                </div>
                                <div class="col-sm-6" align="left">
                                    <input type="text" name="clave_partida" class="form-control col-sm-6" id="partida" 
                                    pattern="[0-9]{5}" onkeypress="validarPartida(event)" required  autofocus>
                                </div>
                            </div>
                        </div><br><br><br>


                        <div align="center">
                            <h3>
                                <small class="text-muted">
                                    Agregar subpartidas.
                                </small>
                            </h3>
                        </div><br>

                        <div class="form-group">
                            {{!-- Boton Agregar --}}
                            <label for="">Agregar</label>
                            <input class="btn btn-outline-success btn-sm" type="button" title="Agregar"
                                Value="+" onclick="insRow('myTable')">&ensp;
                            <!-- Boton Borrar -->
                            <label for="">Borrar</label>
                            <input class="btn btn-outline-danger btn-sm" type="button" title="Borrar" Value="-"
                                onclick="deleteRow('myTable')">
                        </div><br><br>

                        {{!-- Comienza la tabla de subpartidas automatica --}}
                        <table id="myTable" class="table table-sm table-bordered table-striped table-hover">

                            {{!-- Cabecera de la tabla --}}
                            <thead>
                                <tr>
                                    <th scope="col">Clave subpartida</th>
                                    <th scope="col">Descripci√≥n</th>
                                </tr>
                            </thead>

                            {{!-- Campos de la tabla --}}
                            <tr>
                                <td><input type="text" id="clave_subpartida" class="form-control"
                                    onkeypress="validarSubpartida(event)" pattern="[0-9]{3,5}"    name="clave_subpartida" required></td>
                                <td><input type="text" id="descripcion" class="form-control" name="descripcion"
                                         required></td>
                            </tr>

                        </table><br><br>

                        <div class="mx-auto">
                            <button class="btn btn-secondary btn-block col-sm-4"><i
                                    class="fas fa-plus"></i>&ensp;Agregar</button>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

{{!-- Media queries --}}
<style>
    @media (min-width: 768px) {
        #contenedorprincipal {
            width: 75% !important;
        }
    }

    @media (max-width: 767px) {
        #principal {
            margin-left: 0px !important;
        }
    }
</style>

{{!-- Validaciones con JS --}}
<script>
    function deleteRow(id) {
        document.getE
        var ultimo = document.getElementById("myTable").rows.length - 1;
        if (ultimo > 1) {
            document.getElementById(id).deleteRow(ultimo);
        }
    }

    function insRow(id) {
        var filas = document.getElementById("myTable").rows.length;
        var x = document.getElementById(id).insertRow(filas);
        var y = x.insertCell(0);
        var z = x.insertCell(1);

        y.innerHTML = '<input type="text" id="clave_subpartida" class="form-control" name="clave_subpartida" onkeypress="validarSubpartida(event)" pattern="[0-9]{3,5}" placeholder="Subpartida" required>';
        z.innerHTML = '<input type="text" id="descripcion" class="form-control" name="descripcion" placeholder="Descripcion " required>';
    
    
    }


     function validarPartida(event) {
        var a = document.getElementById("partida");
        var b = a.value;
        if (b.length < 5) {
            if ((event.charCode >= 48 && event.charCode <= 57) ) {
                a.value = (b + String.fromCharCode(event.charCode)).toUpperCase();

            }
        }
        event.preventDefault();
    }
    function validarSubpartida(event) {
     
      if(event.charCode<=57 && event.charCode>=48){}
      else{event.preventDefault();}

    
    }
</script>